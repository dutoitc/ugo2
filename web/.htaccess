Options -MultiViews
DirectoryIndex index.html

RewriteEngine On
RewriteBase /

# Anti-récursion si on pointe déjà vers la cible interne
RewriteRule ^src/(front|back)/ - [L]

# 1) API -> back
RewriteRule ^api(?:/.*)?$ src/back/index.php [QSA,END]

# 2) FICHIERS STATIQUES (ex: /ping.txt, /css/app.css, /js/app.js, /img/logo.png)
RewriteCond %{REQUEST_URI} !^/api/
RewriteCond %{DOCUMENT_ROOT}/src/front/$1 -f
RewriteRule ^(.+\.\w+)$ src/front/$1 [END]

# 2b) FICHIERS ANGULAR DANS /browser (ex: /main-*.js, /styles-*.css, /favicon.ico, *.map)
RewriteCond %{REQUEST_URI} !^/api/
RewriteCond %{DOCUMENT_ROOT}/src/front/browser/$1 -f
RewriteRule ^(.+\.\w+)$ src/front/browser/$1 [END]

# 3) DOSSIERS EXISTANTS (ex: /assets/)
RewriteCond %{REQUEST_URI} !^/api/
RewriteCond %{DOCUMENT_ROOT}/src/front/browser/$1 -d
RewriteRule ^(.+)$ src/front/browser/$1 [END]

# 4) Fallback SPA -> index.html
RewriteRule ^ src/front/browser/index.html [END]